# Microsoft 365 Tenant Administration - Task List

- [x] **Initial Authentication**
    - [x] Connect to Microsoft Graph via PowerShell
    - [x] Verify administrator identity and tenant details

- [x] **App Registration Configuration**
    - [x] Create 'VBA_Automation_Tool' application
    - [x] Assign Permissions (`Files.ReadWrite.All`, `Mail.Send`, `Mail.ReadWrite`, `User.Read`)
    - [x] Generate and provide Client Secret

- [x] **Python in Excel Diagnostics**
    - [x] Identify licensing issue ("License required")
    - [x] Confirm no blocking "Office Cloud Policies"
    - [x] Advise on "Python in Excel" add-on purchase

- [/] **Tenant Health Check**
    - [x] Re-authenticate with `ServiceHealth.Read.All` scope
    - [/] Retrieve and display service health overview

- [x] **Phase 32 : Maintenance et Synchronisation (Février 2026)**
    - [x] Validation de l'intégrité du workspace (Manifeste, Compilation)
    - [x] Mise à jour du manifeste avec les nouveaux modules (`modGraphClient`, `modSecureUpdate`)

- [/] **Phase 33 : Résolution des Problèmes d'Encodage (Février 2026)**
    - [x] Diagnostic des fichiers affectés par le Mojibake
    - [x] Correction de [modSGQCreation.bas](file:///C:/VBA/SGQ%201.65/vba-files/Module/modSGQCreation.bas) (accentuation restaurée)
    - [x] Audit de [modSGQUpdateManager.bas](file:///C:/VBA/SGQ%201.65/vba-files/Module/modSGQUpdateManager.bas) et [modSecureUpdate.bas](file:///C:/VBA/SGQ%201.65/vba-files/Module/modSecureUpdate.bas) (OK)
    - [ ] Mise en place de préventions supplémentaires (Optionnel)

- [ ] **Macro Security Support**
    - [ ] (Pending User Action) User to add OneDrive path to Trusted Locations
    - [x] (Optional) Test VBA access with new App RegistrationCredentials

- [/] **Blocking Policies Analysis**
    - [x] Authenticate with Policy Read Scope
    - [x] Check Conditional Access Policies
    - [x] Check Security Defaults status
    - [x] Review Tenant-wide settings for specific service blocks

- [x] **Fixing Application Permissions**
    - [x] Identify missing Application Roles (Files.ReadWrite.All)
    - [x] Authenticate with AppRoleAssignment.ReadWrite.All
    - [x] Grant Admin Consent for new roles
    - [x] Verify functionality with VBA Test Script (Ready for user test)
    - [x] Verify functionality with VBA Test Script (Ready for user test)

- [x] **Microsoft Graph Client Integration**
    - [x] Create `C:\VBA\SGQ 1.65\modules\modGraphClient.bas`
    - [x] Update [modConstants.bas](file:///C:/VBA/SGQ%201.65/logs/vba_backups/import_backup_20250925_085827/Module/modConstants.bas) with Graph credentials
    - [x] Verify [JsonConverter.bas](file:///C:/VBA/SGQ%201.65/vba-files/Module/JsonConverter.bas) dependency

- [x] **Secure Update Implementation**
    - [x] Create `C:\VBA\SGQ 1.65\modules\modSecureUpdate.bas`
    - [x] Implement `CheckForUpdates` using `modGraphClient`
    - [x] Implement `DownloadUpdateFiles` from Graph
    - [x] Integrate with `modSGQUpdateManager` (User testing CheckForUpdates)
    - [x] Create Deployment Plan ([docs/UPDATE_DEPLOYMENT_PLAN.md](file:///C:/VBA/SGQ%201.65/docs/UPDATE_DEPLOYMENT_PLAN.md))
