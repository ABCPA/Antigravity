# Implementation Plan - Vue Suivi UI

## Goal Description
The user wants to easily toggle between "System View" (all sheets) and "Tracking View" (relevant sheets only). This feature is implemented in `modSGQViews` but lacks UI entry points.
We will:
1.  Add a button to the Excel Ribbon ("Vue Suivi").
2.  Create a helper to add buttons directly to worksheets for quick access.

## User Review Required
> [!NOTE]
> The Ribbon change requires a re-import or manual update of the CustomUI part in the Excel file if not using a dynamic loader. The user seems to be using an external XML file [c:\VBA\SGQ 1.65\ribbons\customUI14.xml](file:///VBA/SGQ%201.65/ribbons/customUI14.xml) which is likely loaded by a script or tool.

## Proposed Changes

### Ribbon
#### [MODIFY] [customUI14.xml](file:///c:/VBA/SGQ%201.65/ribbons/customUI14.xml)
- Add `<button id="btnToggleView" label="Vue Suivi" imageMso="ViewSwitch" size="large" onAction="CallbackToggleView" />` to `grpActions`.
- Verify/Remove `btnUpdateView` if unused/confusing.

### VBA Modules
#### [MODIFY] [modRibbonSGQ.bas](file:///c:/VBA/SGQ%201.65/vba-files/Module/modRibbonSGQ.bas)
- Ensure `CallbackToggleView` is present and correct (Confirmed in research).

#### [MODIFY] [modSGQInterface.bas](file:///c:/VBA/SGQ%201.65/vba-files/Module/modSGQInterface.bas)
- Add `Public Sub AddTrackingButtonToWorksheets()`
  - Iterates through Tracking Sheets (from `modConstants`).
  - Adds a button (Form Control) assigned to `modSGQViews.ToggleViewMode`.
  - Poistions it (e.g., cell A1 or top right).

## Verification Plan

### Automated Tests
- None possible for UI appearance.
- Compilation check using `scripts/validate-assistant-config.ps1` (implied workflow).

### Manual Verification
- **Ribbon**:
  1.  Reload the Ribbon/Add-in.
  2.  Click "Vue Suivi".
  3.  Verify sheets hide/show and message box appears.
- **Worksheet Button**:
  1.  Run `modSGQInterface.AddTrackingButtonToWorksheets` via Immediate Window.
  2.  Check a tracking sheet (e.g., "Suivi").
  3.  Click the new button.
  4.  Verify view toggles.
